---
title: "SSC 442 Group 8"
author: "Alison Ferer, Clay Herwat, Arie Park, Haoyan Lin"
date: "October 9, 2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
## you may need to change where the data is being pulled from depending on where it is stored on your computer
library(tidyverse)
library(lubridate)
library(ggplot2)
rats_raw <- read_csv("Rat_Sightings.csv", na = c("", "NA", "N/A"))
rats_clean <- rats_raw %>%
     rename(created_date = `Created Date`,
            location_type = `Location Type`,
            borough = Borough) %>%
     mutate(created_date = mdy_hms(created_date)) %>%
     mutate(sighting_year = year(created_date),
            sighting_month = month(created_date),
            sighting_day = day(created_date),
            sighting_weekday = wday(created_date, label = TRUE, abbr = FALSE)) %>%
     filter(borough != "Unspecified")
```

```{r}
 rats_clean %>% 
  group_by(sighting_month, borough, sighting_year) %>% 
  summarize(count=n()) %>%
  ggplot(aes(x=sighting_month, y= count, fill= borough))+ 
  geom_col()+ 
  facet_wrap(vars(sighting_year))+
  xlab(NULL)+
  ylab(NULL)+
  ggtitle("Rat Sightings from 2010 to 2020")+
  theme(legend.position="bottom")+
  scale_fill_discrete(name= "Borough", labels= c("Bronx","Brooklyn","Manhattan","Queens","Staten Island"))+
  theme_minimal() +
  theme(strip.text = element_text(face = "bold"),
        plot.title = element_text(face = "bold"),
        axis.text.x = element_text(angle = 45, hjust = 1))
```
```{r}
## animation, install gganimate if you don't have it
library(gganimate)
p + transition_time(sighting_year)+ labs(title = "Year: {round(frame_time,digits=0)}")
```

